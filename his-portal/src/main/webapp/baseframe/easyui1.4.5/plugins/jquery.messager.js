!function(e){function t(){e(document).unbind(".messager").bind("keydown.messager",function(t){if(27==t.keyCode)e("body").children("div.messager-window").children("div.messager-body").each(function(){e(this).dialog("close")});else if(9==t.keyCode){var o=e("body").children("div.messager-window");if(!o.length)return;for(var s=o.find(".messager-input,.messager-button .l-btn"),n=0;n<s.length;n++)if(e(s[n]).is(":focus"))return e(s[n>=s.length-1?0:n+1]).focus(),!1}else if(13==t.keyCode){var a=e(t.target).closest("input.messager-input");if(a.length){var r=a.closest(".messager-body");i(r,a.val())}}})}function o(){e(document).unbind(".messager")}function s(t){var o=e.extend({},e.messager.defaults,{modal:!1,shadow:!1,draggable:!1,resizable:!1,closed:!0,style:{left:"",top:"",right:0,zIndex:e.fn.window.defaults.zIndex++,bottom:-document.body.scrollTop-document.documentElement.scrollTop},title:"",width:250,height:100,minHeight:0,showType:"slide",showSpeed:600,content:t.msg,timeout:4e3},t),s=e('<div class="messager-body"></div>').appendTo("body");return s.dialog(e.extend({},o,{noheader:!o.title,openAnimation:o.showType,closeAnimation:"show"==o.showType?"hide":o.showType,openDuration:o.showSpeed,closeDuration:o.showSpeed,onOpen:function(){function e(){o.timeout>0&&(o.timer=setTimeout(function(){s.length&&s.data("dialog")&&s.dialog("close")},o.timeout))}s.dialog("dialog").hover(function(){o.timer&&clearTimeout(o.timer)},function(){e()}),e(),t.onOpen?t.onOpen.call(this):o.onOpen.call(this)},onClose:function(){o.timer&&clearTimeout(o.timer),t.onClose?t.onClose.call(this):o.onClose.call(this),s.dialog("destroy")}})),s.dialog("dialog").css(o.style),s.dialog("open"),s}function n(s){t();var n=e('<div class="messager-body"></div>').appendTo("body");n.dialog(e.extend({},s,{noheader:!s.title,onClose:function(){o(),s.onClose&&s.onClose.call(this),setTimeout(function(){n.dialog("destroy")},100)}}));var i=n.dialog("dialog").addClass("messager-window");return i.find(".dialog-button").addClass("messager-button").find("a:first").focus(),n}function i(e,t){e.dialog("close"),e.dialog("options").fn(t)}e.messager={show:function(e){return s(e)},alert:function(t,o,s,a){var r="object"==typeof t?t:{title:t,msg:o,icon:s,fn:a},l=r.icon?"messager-icon messager-"+r.icon:"";r=e.extend({},e.messager.defaults,{content:'<div class="'+l+'"></div><div>'+r.msg+'</div><div style="clear:both;"/>'},r),r.buttons||(r.buttons=[{text:r.ok,onClick:function(){i(d)}}]);var d=n(r);return d},confirm:function(t,o,s){var a="object"==typeof t?t:{title:t,msg:o,fn:s};a=e.extend({},e.messager.defaults,{content:'<div class="messager-icon messager-question"></div><div>'+a.msg+'</div><div style="clear:both;"/>'},a),a.buttons||(a.buttons=[{text:a.ok,onClick:function(){i(r,!0)}},{text:a.cancel,onClick:function(){i(r,!1)}}]);var r=n(a);return r},prompt:function(t,o,s){var a="object"==typeof t?t:{title:t,msg:o,fn:s};a=e.extend({},e.messager.defaults,{content:'<div class="messager-icon messager-question"></div><div>'+a.msg+'</div><br/><div style="clear:both;"/><div><input class="messager-input" type="text"/></div>'},a),a.buttons||(a.buttons=[{text:a.ok,onClick:function(){i(r,r.find(".messager-input").val())}},{text:a.cancel,onClick:function(){i(r)}}]);var r=n(a);return r.find(".messager-input").focus(),r},progress:function(t){var o={bar:function(){return e("body>div.messager-window").find("div.messager-p-bar")},close:function(){var t=e("body>div.messager-window>div.messager-body:has(div.messager-progress)");t.length&&t.dialog("close")}};if("string"==typeof t){var s=o[t];return s()}t=t||{};var i=e.extend({},{title:"",minHeight:0,content:void 0,msg:"",text:void 0,interval:300},t),a=n(e.extend({},e.messager.defaults,{content:'<div class="messager-progress"><div class="messager-p-msg">'+i.msg+'</div><div class="messager-p-bar"></div></div>',closable:!1,doSize:!1},i,{onClose:function(){this.timer&&clearInterval(this.timer),t.onClose?t.onClose.call(this):e.messager.defaults.onClose.call(this)}})),r=a.find("div.messager-p-bar");return r.progressbar({text:i.text}),a.dialog("resize"),i.interval&&(a[0].timer=setInterval(function(){var e=r.progressbar("getValue");e+=10,e>100&&(e=0),r.progressbar("setValue",e)},i.interval)),a}},e.messager.defaults=e.extend({},e.fn.dialog.defaults,{ok:"Ok",cancel:"Cancel",width:300,height:"auto",minHeight:150,modal:!0,collapsible:!1,minimizable:!1,maximizable:!1,resizable:!1,fn:function(){}})}(jQuery);