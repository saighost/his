!function(t){function e(e,o){var i=t.data(e,"form").options;t.extend(i,o||{});var r=t.extend({},i.queryParams);if(0!=i.onSubmit.call(e,r)){var s=t(e).find(".textbox-text:focus");s.triggerHandler("blur"),s.focus(),i.iframe?n(e,r):void 0!==window.FormData?a(e,r):n(e,r)}}function n(e,n){function a(n){var a=t(e);r.url&&a.attr("action",r.url);var i=a.attr("target"),f=a.attr("action");a.attr("target",s);var c=t();try{for(var d in n){var u=t('<input type="hidden" name="'+d+'">').val(n[d]).appendTo(a);c=c.add(u)}o(),a[0].submit()}finally{a.attr("action",f),i?a.attr("target",i):a.removeAttr("target"),c.remove()}}function o(){var e=t("#"+s);if(e.length)try{var n=e.contents()[0].readyState;n&&"uninitialized"==n.toLowerCase()&&setTimeout(o,100)}catch(a){i()}}function i(){var n=t("#"+s);if(n.length){n.unbind();var a="";try{var o=n.contents().find("body");if(a=o.html(),""==a&&--c)return void setTimeout(i,100);var f=o.find(">textarea");if(f.length)a=f.val();else{var d=o.find(">pre");d.length&&(a=d.html())}}catch(u){}r.success.call(e,a),setTimeout(function(){n.unbind(),n.remove()},100)}}var r=t.data(e,"form").options,s="easyui_frame_"+(new Date).getTime(),f=t("<iframe id="+s+" name="+s+"></iframe>").appendTo("body");f.attr("src",window.ActiveXObject?"javascript:false":"about:blank"),f.css({position:"absolute",top:-1e3,left:-1e3}),f.bind("load",i),a(n);var c=10}function a(e,n){var a=t.data(e,"form").options,o=new FormData(t(e)[0]);for(var i in n)o.append(i,n[i]);t.ajax({url:a.url,type:"post",xhr:function(){var n=t.ajaxSettings.xhr();return n.upload&&n.upload.addEventListener("progress",function(t){if(t.lengthComputable){var n=t.total,o=t.loaded||t.position,i=Math.ceil(100*o/n);a.onProgress.call(e,i)}},!1),n},data:o,dataType:"html",cache:!1,contentType:!1,processData:!1,complete:function(t){a.success.call(e,t.responseText)}})}function o(e,n){function a(n){var a=t(e);for(var i in n){var f=n[i];o(i,f)||r(i,f)||(a.find('input[name="'+i+'"]').val(f),a.find('textarea[name="'+i+'"]').val(f),a.find('select[name="'+i+'"]').val(f))}s.onLoadSuccess.call(e,n),a.form("validate")}function o(n,a){var o=t(e).find('[switchbuttonName="'+n+'"]');return o.length?(o.switchbutton("uncheck"),o.each(function(){i(t(this).switchbutton("options").value,a)&&t(this).switchbutton("check")}),!0):(o=t(e).find('input[name="'+n+'"][type=radio], input[name="'+n+'"][type=checkbox]'),!!o.length&&(o._propAttr("checked",!1),o.each(function(){i(t(this).val(),a)&&t(this)._propAttr("checked",!0)}),!0))}function i(e,n){return e==String(n)||t.inArray(e,t.isArray(n)?n:[n])>=0}function r(n,a){var o=t(e).find('[textboxName="'+n+'"],[sliderName="'+n+'"]');if(o.length)for(var i=0;i<s.fieldTypes.length;i++){var r=s.fieldTypes[i],f=o.data(r);if(f)return f.options.multiple||f.options.range?o[r]("setValues",a):o[r]("setValue",a),!0}return!1}var s=t.data(e,"form").options;if("string"==typeof n){var f={};if(0==s.onBeforeLoad.call(e,f))return;t.ajax({url:n,data:f,dataType:"json",success:function(t){a(t)},error:function(){s.onLoadError.apply(e,arguments)}})}else a(n)}function i(e){t("input,select,textarea",e).each(function(){var e=this.type,n=this.tagName.toLowerCase();if("text"==e||"hidden"==e||"password"==e||"textarea"==n)this.value="";else if("file"==e){var a=t(this);if(!a.hasClass("textbox-value")){var o=a.clone().val("");o.insertAfter(a),a.data("validatebox")?(a.validatebox("destroy"),o.validatebox()):a.remove()}}else"checkbox"==e||"radio"==e?this.checked=!1:"select"==n&&(this.selectedIndex=-1)});for(var n=t(e),a=t.data(e,"form").options,o=a.fieldTypes.length-1;o>=0;o--){var i=a.fieldTypes[o],r=n.find("."+i+"-f");r.length&&r[i]&&r[i]("clear")}n.form("validate")}function r(e){e.reset();for(var n=t(e),a=t.data(e,"form").options,o=a.fieldTypes.length-1;o>=0;o--){var i=a.fieldTypes[o],r=n.find("."+i+"-f");r.length&&r[i]&&r[i]("reset")}n.form("validate")}function s(n){var a=t.data(n,"form").options;t(n).unbind(".form"),a.ajax&&t(n).bind("submit.form",function(){return setTimeout(function(){e(n,a)},0),!1}),t(n).bind("_change.form",function(t,e){a.onChange.call(this,e)}).bind("change.form",function(e){var n=e.target;t(n).hasClass("textbox-text")||a.onChange.call(this,n)}),d(n,a.novalidate)}function f(e,n){n=n||{};var a=t.data(e,"form");a?t.extend(a.options,n):t.data(e,"form",{options:t.extend({},t.fn.form.defaults,t.fn.form.parseOptions(e),n)})}function c(e){if(t.fn.validatebox){var n=t(e);n.find(".validatebox-text:not(:disabled)").validatebox("validate");var a=n.find(".validatebox-invalid");return a.filter(":not(:disabled):first").focus(),0==a.length}return!0}function d(e,n){var a=t.data(e,"form").options;a.novalidate=n,t(e).find(".validatebox-text:not(:disabled)").validatebox(n?"disableValidation":"enableValidation")}t.fn.form=function(e,n){return"string"==typeof e?(this.each(function(){f(this)}),t.fn.form.methods[e](this,n)):this.each(function(){f(this,e),s(this)})},t.fn.form.methods={options:function(e){return t.data(e[0],"form").options},submit:function(t,n){return t.each(function(){e(this,n)})},load:function(t,e){return t.each(function(){o(this,e)})},clear:function(t){return t.each(function(){i(this)})},reset:function(t){return t.each(function(){r(this)})},validate:function(t){return c(t[0])},disableValidation:function(t){return t.each(function(){d(this,!0)})},enableValidation:function(t){return t.each(function(){d(this,!1)})},resetValidation:function(e){return e.each(function(){t(this).find(".validatebox-text:not(:disabled)").validatebox("resetValidation")})}},t.fn.form.parseOptions=function(e){var n=t(e);return t.extend({},t.parser.parseOptions(e,[{ajax:"boolean"}]),{url:n.attr("action")?n.attr("action"):void 0})},t.fn.form.defaults={fieldTypes:["combobox","combotree","combogrid","datetimebox","datebox","combo","datetimespinner","timespinner","numberspinner","spinner","slider","searchbox","numberbox","textbox","switchbutton"],novalidate:!1,ajax:!0,iframe:!0,url:null,queryParams:{},onSubmit:function(e){return t(this).form("validate")},onProgress:function(t){},success:function(t){},onBeforeLoad:function(t){},onLoadSuccess:function(t){},onLoadError:function(){},onChange:function(t){}}}(jQuery);