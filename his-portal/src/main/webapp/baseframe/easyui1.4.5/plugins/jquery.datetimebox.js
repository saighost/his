!function(t){function e(e){var n=t.data(e,"datetimebox"),o=n.options;if(t(e).datebox(t.extend({},o,{onShowPanel:function(){var e=t(this).datetimebox("getValue");i(this,e,!0),o.onShowPanel.call(this)},formatter:t.fn.datebox.defaults.formatter,parser:t.fn.datebox.defaults.parser})),t(e).removeClass("datebox-f").addClass("datetimebox-f"),t(e).datebox("calendar").calendar({onSelect:function(t){o.onSelect.call(this.target,t)}}),!n.spinner){var a=t(e).datebox("panel"),r=t('<div style="padding:2px"><input></div>').insertAfter(a.children("div.datebox-calendar-inner"));n.spinner=r.children("input")}n.spinner.timespinner({width:o.spinnerWidth,showSeconds:o.showSeconds,separator:o.timeSeparator}),t(e).datetimebox("initValue",o.value)}function n(e){var n=t(e).datetimebox("calendar"),o=t(e).datetimebox("spinner"),a=n.calendar("options").current;return new Date(a.getFullYear(),a.getMonth(),a.getDate(),o.timespinner("getHours"),o.timespinner("getMinutes"),o.timespinner("getSeconds"))}function o(t,e){i(t,e,!0)}function a(e){var o=t.data(e,"datetimebox").options,a=n(e);i(e,o.formatter.call(e,a)),t(e).combo("hidePanel")}function i(e,n,o){function a(n){function o(t){return(t<10?"0":"")+t}var a=[o(n.getHours()),o(n.getMinutes())];return i.showSeconds&&a.push(o(n.getSeconds())),a.join(t(e).datetimebox("spinner").timespinner("options").separator)}var i=t.data(e,"datetimebox").options;if(t(e).combo("setValue",n),!o)if(n){var r=i.parser.call(e,n);t(e).combo("setText",i.formatter.call(e,r)),t(e).combo("setValue",i.formatter.call(e,r))}else t(e).combo("setText",n);var r=i.parser.call(e,n);t(e).datetimebox("calendar").calendar("moveTo",r),t(e).datetimebox("spinner").timespinner("setValue",a(r))}t.fn.datetimebox=function(n,o){if("string"==typeof n){var a=t.fn.datetimebox.methods[n];return a?a(this,o):this.datebox(n,o)}return n=n||{},this.each(function(){var o=t.data(this,"datetimebox");o?t.extend(o.options,n):t.data(this,"datetimebox",{options:t.extend({},t.fn.datetimebox.defaults,t.fn.datetimebox.parseOptions(this),n)}),e(this)})},t.fn.datetimebox.methods={options:function(e){var n=e.datebox("options");return t.extend(t.data(e[0],"datetimebox").options,{originalValue:n.originalValue,disabled:n.disabled,readonly:n.readonly})},cloneFrom:function(e,n){return e.each(function(){t(this).datebox("cloneFrom",n),t.data(this,"datetimebox",{options:t.extend(!0,{},t(n).datetimebox("options")),spinner:t(n).datetimebox("spinner")}),t(this).removeClass("datebox-f").addClass("datetimebox-f")})},spinner:function(e){return t.data(e[0],"datetimebox").spinner},initValue:function(e,n){return e.each(function(){var e=t(this).datetimebox("options"),n=e.value;n&&(n=e.formatter.call(this,e.parser.call(this,n))),t(this).combo("initValue",n).combo("setText",n)})},setValue:function(t,e){return t.each(function(){i(this,e)})},reset:function(e){return e.each(function(){var e=t(this).datetimebox("options");t(this).datetimebox("setValue",e.originalValue)})}},t.fn.datetimebox.parseOptions=function(e){t(e);return t.extend({},t.fn.datebox.parseOptions(e),t.parser.parseOptions(e,["timeSeparator","spinnerWidth",{showSeconds:"boolean"}]))},t.fn.datetimebox.defaults=t.extend({},t.fn.datebox.defaults,{spinnerWidth:"100%",showSeconds:!0,timeSeparator:":",keyHandler:{up:function(t){},down:function(t){},left:function(t){},right:function(t){},enter:function(t){a(this)},query:function(t,e){o(this,t)}},buttons:[{text:function(e){return t(e).datetimebox("options").currentText},handler:function(e){var n=t(e).datetimebox("options");i(e,n.formatter.call(e,new Date)),t(e).datetimebox("hidePanel")}},{text:function(e){return t(e).datetimebox("options").okText},handler:function(t){a(t)}},{text:function(e){return t(e).datetimebox("options").closeText},handler:function(e){t(e).datetimebox("hidePanel")}}],formatter:function(e){function n(t){return(t<10?"0":"")+t}var o=e.getHours(),a=e.getMinutes(),i=e.getSeconds(),r=t(this).datetimebox("spinner").timespinner("options").separator,s=t.fn.datebox.defaults.formatter(e)+" "+n(o)+r+n(a);return t(this).datetimebox("options").showSeconds&&(s+=r+n(i)),s},parser:function(e){if(""==t.trim(e))return new Date;var n=e.split(" "),o=t.fn.datebox.defaults.parser(n[0]);if(n.length<2)return o;var a=t(this).datetimebox("spinner").timespinner("options").separator,i=n[1].split(a),r=parseInt(i[0],10)||0,s=parseInt(i[1],10)||0,d=parseInt(i[2],10)||0;return new Date(o.getFullYear(),o.getMonth(),o.getDate(),r,s,d)}})}(jQuery);