!function(t){function e(e){t(e).addClass("textbox-f").hide();var o=t('<span class="textbox"><input class="textbox-text" autocomplete="off"><input type="hidden" class="textbox-value"></span>').insertAfter(e),n=t(e).attr("name");return n&&(o.find("input.textbox-value").attr("name",n),t(e).removeAttr("name").attr("textboxName",n)),o}function o(e){var o=t.data(e,"textbox"),n=o.options,i=o.textbox;i.find(".textbox-text").remove(),n.multiline?t('<textarea class="textbox-text" autocomplete="off"></textarea>').prependTo(i):t('<input type="'+n.type+'" class="textbox-text" autocomplete="off">').prependTo(i),i.find(".textbox-addon").remove();var x=n.icons?t.extend(!0,[],n.icons):[];if(n.iconCls&&x.push({iconCls:n.iconCls,disabled:!0}),x.length){var l=t('<span class="textbox-addon"></span>').prependTo(i);l.addClass("textbox-addon-"+n.iconAlign);for(var r=0;r<x.length;r++)l.append('<a href="javascript:void(0)" class="textbox-icon '+x[r].iconCls+'" icon-index="'+r+'" tabindex="-1"></a>')}if(i.find(".textbox-button").remove(),n.buttonText||n.buttonIcon){var b=t('<a href="javascript:void(0)" class="textbox-button"></a>').prependTo(i);b.addClass("textbox-button-"+n.buttonAlign).linkbutton({text:n.buttonText,iconCls:n.buttonIcon})}a(e),s(e,n.disabled),d(e,n.readonly)}function n(e){var o=t.data(e,"textbox").textbox;o.find(".textbox-text").validatebox("destroy"),o.remove(),t(e).remove()}function i(e,o){function n(t){return(a.iconAlign==t?u._outerWidth():0)+(a.buttonAlign==t?b._outerWidth():0)}var i=t.data(e,"textbox"),a=i.options,x=i.textbox,s=x.parent();if(o&&(a.width=o),isNaN(parseInt(a.width))){var d=t(e).clone();d.css("visibility","hidden"),d.insertAfter(e),a.width=d.outerWidth(),d.remove()}var l=x.is(":visible");l||x.appendTo("body");var r=x.find(".textbox-text"),b=x.find(".textbox-button"),u=x.find(".textbox-addon"),c=u.find(".textbox-icon");x._size(a,s),b.linkbutton("resize",{height:x.height()}),b.css({left:"left"==a.buttonAlign?0:"",right:"right"==a.buttonAlign?0:""}),u.css({left:"left"==a.iconAlign?"left"==a.buttonAlign?b._outerWidth():0:"",right:"right"==a.iconAlign?"right"==a.buttonAlign?b._outerWidth():0:""}),c.css({width:a.iconWidth+"px",height:x.height()+"px"}),r.css({paddingLeft:e.style.paddingLeft||"",paddingRight:e.style.paddingRight||"",marginLeft:n("left"),marginRight:n("right")}),a.multiline?(r.css({paddingTop:e.style.paddingTop||"",paddingBottom:e.style.paddingBottom||""}),r._outerHeight(x.height())):r.css({paddingTop:0,paddingBottom:0,height:x.height()+"px",lineHeight:x.height()+"px"}),r._outerWidth(x.width()-c.length*a.iconWidth-b._outerWidth()),l||x.insertAfter(e),a.onResize.call(e,a.width,a.height)}function a(e){var o=t(e).textbox("options"),n=t(e).textbox("textbox");n.validatebox(t.extend({},o,{deltaX:t(e).textbox("getTipX"),onBeforeValidate:function(){o.onBeforeValidate.call(e);var n=t(this);n.is(":focus")||(o.oldInputValue=n.val(),n.val(o.value))},onValidate:function(n){var i=t(this);void 0!=o.oldInputValue&&(i.val(o.oldInputValue),o.oldInputValue=void 0);var a=i.parent();n?a.removeClass("textbox-invalid"):a.addClass("textbox-invalid"),o.onValidate.call(e,n)}}))}function x(e){var o=t.data(e,"textbox"),n=o.options,a=o.textbox,x=a.find(".textbox-text");if(x.attr("placeholder",n.prompt),x.unbind(".textbox"),!n.disabled&&!n.readonly){x.bind("blur.textbox",function(e){a.hasClass("textbox-focused")&&(n.value=t(this).val(),""==n.value?t(this).val(n.prompt).addClass("textbox-prompt"):t(this).removeClass("textbox-prompt"),a.removeClass("textbox-focused"))}).bind("focus.textbox",function(e){a.hasClass("textbox-focused")||(t(this).val()!=n.value&&t(this).val(n.value),t(this).removeClass("textbox-prompt"),a.addClass("textbox-focused"))});for(var s in n.inputEvents)x.bind(s+".textbox",{target:e},n.inputEvents[s])}var d=a.find(".textbox-addon");d.unbind().bind("click",{target:e},function(o){var i=t(o.target).closest("a.textbox-icon:not(.textbox-icon-disabled)");if(i.length){var a=parseInt(i.attr("icon-index")),x=n.icons[a];x&&x.handler&&(x.handler.call(i[0],o),n.onClickIcon.call(e,a))}}),d.find(".textbox-icon").each(function(e){var o=n.icons[e],i=t(this);!o||o.disabled||n.disabled||n.readonly?i.addClass("textbox-icon-disabled"):i.removeClass("textbox-icon-disabled")});var l=a.find(".textbox-button");l.unbind(".textbox").bind("click.textbox",function(){l.linkbutton("options").disabled||n.onClickButton.call(e)}),l.linkbutton(n.disabled||n.readonly?"disable":"enable"),a.unbind(".textbox").bind("_resize.textbox",function(o,n){return(t(this).hasClass("easyui-fluid")||n)&&i(e),!1})}function s(e,o){var n=t.data(e,"textbox"),i=n.options,a=n.textbox,x=a.find(".textbox-text"),s=t(e).add(a.find(".textbox-value"));i.disabled=o,i.disabled?(x.validatebox("disable"),a.addClass("textbox-disabled"),s.attr("disabled","disabled")):(x.validatebox("enable"),a.removeClass("textbox-disabled"),s.removeAttr("disabled"))}function d(e,o){var n=t.data(e,"textbox"),i=n.options,a=n.textbox,x=a.find(".textbox-text");x.validatebox("readonly",o),i.readonly=x.validatebox("options").readonly,a.removeClass("textbox-readonly").addClass(i.readonly?"textbox-readonly":"")}t.fn.textbox=function(n,a){if("string"==typeof n){var s=t.fn.textbox.methods[n];return s?s(this,a):this.each(function(){var e=t(this).textbox("textbox");e.validatebox(n,a)})}return n=n||{},this.each(function(){var a=t.data(this,"textbox");a?(t.extend(a.options,n),void 0!=n.value&&(a.options.originalValue=n.value)):(a=t.data(this,"textbox",{options:t.extend({},t.fn.textbox.defaults,t.fn.textbox.parseOptions(this),n),textbox:e(this)}),a.options.originalValue=a.options.value),o(this),x(this),i(this),t(this).textbox("initValue",a.options.value)})},t.fn.textbox.methods={options:function(e){return t.data(e[0],"textbox").options},cloneFrom:function(e,o){return e.each(function(){var e=t(this);if(!e.data("textbox")){t(o).data("textbox")||t(o).textbox();var n=e.attr("name")||"";e.addClass("textbox-f").hide(),e.removeAttr("name").attr("textboxName",n);var i=t(o).next().clone().insertAfter(e);i.find("input.textbox-value").attr("name",n),t.data(this,"textbox",{options:t.extend(!0,{},t(o).textbox("options")),textbox:i});var s=t(o).textbox("button");s.length&&e.textbox("button").linkbutton(t.extend(!0,{},s.linkbutton("options"))),x(this),a(this)}})},textbox:function(e){return t.data(e[0],"textbox").textbox.find(".textbox-text")},button:function(e){return t.data(e[0],"textbox").textbox.find(".textbox-button")},destroy:function(t){return t.each(function(){n(this)})},resize:function(t,e){return t.each(function(){i(this,e)})},disable:function(t){return t.each(function(){s(this,!0),x(this)})},enable:function(t){return t.each(function(){s(this,!1),x(this)})},readonly:function(t,e){return t.each(function(){d(this,e),x(this)})},isValid:function(t){return t.textbox("textbox").validatebox("isValid")},clear:function(e){return e.each(function(){t(this).textbox("setValue","")})},setText:function(e,o){return e.each(function(){var e=t(this).textbox("options"),n=t(this).textbox("textbox");o=void 0==o?"":String(o),t(this).textbox("getText")!=o&&n.val(o),e.value=o,n.is(":focus")||(o?n.removeClass("textbox-prompt"):n.val(e.prompt).addClass("textbox-prompt")),t(this).textbox("validate")})},initValue:function(e,o){return e.each(function(){var e=t.data(this,"textbox");e.options.value="",t(this).textbox("setText",o),e.textbox.find(".textbox-value").val(o),t(this).val(o)})},setValue:function(e,o){return e.each(function(){var e=t.data(this,"textbox").options,n=t(this).textbox("getValue");t(this).textbox("initValue",o),n!=o&&(e.onChange.call(this,o,n),t(this).closest("form").trigger("_change",[this]))})},getText:function(t){var e=t.textbox("textbox");return e.is(":focus")?e.val():t.textbox("options").value},getValue:function(t){return t.data("textbox").textbox.find(".textbox-value").val()},reset:function(e){return e.each(function(){var e=t(this).textbox("options");t(this).textbox("setValue",e.originalValue)})},getIcon:function(t,e){return t.data("textbox").textbox.find(".textbox-icon:eq("+e+")")},getTipX:function(t){var e=t.data("textbox"),o=e.options,n=e.textbox,i=(n.find(".textbox-text"),n.find(".textbox-addon")._outerWidth()),a=n.find(".textbox-button")._outerWidth();return"right"==o.tipPosition?("right"==o.iconAlign?i:0)+("right"==o.buttonAlign?a:0)+1:"left"==o.tipPosition?("left"==o.iconAlign?-i:0)+("left"==o.buttonAlign?-a:0)-1:i/2*("right"==o.iconAlign?1:-1)}},t.fn.textbox.parseOptions=function(e){var o=t(e);return t.extend({},t.fn.validatebox.parseOptions(e),t.parser.parseOptions(e,["prompt","iconCls","iconAlign","buttonText","buttonIcon","buttonAlign",{multiline:"boolean",iconWidth:"number"}]),{value:o.val()||void 0,type:o.attr("type")?o.attr("type"):void 0})},t.fn.textbox.defaults=t.extend({},t.fn.validatebox.defaults,{width:"auto",height:22,prompt:"",value:"",type:"text",multiline:!1,icons:[],iconCls:null,iconAlign:"right",iconWidth:18,buttonText:"",buttonIcon:null,buttonAlign:"right",inputEvents:{blur:function(e){var o=t(e.data.target),n=o.textbox("options");o.textbox("setValue",n.value)},keydown:function(e){if(13==e.keyCode){var o=t(e.data.target);o.textbox("setValue",o.textbox("getText"))}}},onChange:function(t,e){},onResize:function(t,e){},onClickButton:function(){},onClickIcon:function(t){}})}(jQuery);