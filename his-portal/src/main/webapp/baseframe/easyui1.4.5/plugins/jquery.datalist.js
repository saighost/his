!function(t){function a(a){var e=t.data(a,"datalist").options;t(a).datagrid(t.extend({},e,{cls:"datalist"+(e.lines?" datalist-lines":""),frozenColumns:e.frozenColumns&&e.frozenColumns.length?e.frozenColumns:e.checkbox?[[{field:"_ck",checkbox:!0}]]:void 0,columns:e.columns&&e.columns.length?e.columns:[[{field:e.textField,width:"100%",formatter:function(t,a,r){return e.textFormatter?e.textFormatter(t,a,r):t}}]]}))}var e=t.extend({},t.fn.datagrid.defaults.view,{render:function(a,e,r){var o=t.data(a,"datagrid"),s=o.options;if(s.groupField){var n=this.groupRows(a,o.data.rows);this.groups=n.groups,o.data.rows=n.rows;for(var i=[],d=0;d<n.groups.length;d++)i.push(this.renderGroup.call(this,a,d,n.groups[d],r));t(e).html(i.join(""))}else t(e).html(this.renderTable(a,0,o.data.rows,r))},renderGroup:function(a,e,r,o){var s=t.data(a,"datagrid"),n=s.options,i=(t(a).datagrid("getColumnFields",o),[]);return i.push('<div class="datagrid-group" group-index='+e+">"),o||(i.push('<span class="datagrid-group-title">'),i.push(n.groupFormatter.call(a,r.value,r.rows)),i.push("</span>")),i.push("</div>"),i.push(this.renderTable(a,r.startIndex,r.rows,o)),i.join("")},groupRows:function(a,e){function r(t){for(var a=0;a<n.length;a++){var e=n[a];if(e.value==t)return e}return null}for(var o=t.data(a,"datagrid"),s=o.options,n=[],i=0;i<e.length;i++){var d=e[i],l=r(d[s.groupField]);l?l.rows.push(d):(l={value:d[s.groupField],rows:[d]},n.push(l))}for(var u=0,e=[],i=0;i<n.length;i++){var l=n[i];l.startIndex=u,u+=l.rows.length,e=e.concat(l.rows)}return{groups:n,rows:e}}});t.fn.datalist=function(e,r){if("string"==typeof e){var o=t.fn.datalist.methods[e];return o?o(this,r):this.datagrid(e,r)}return e=e||{},this.each(function(){var r=t.data(this,"datalist");if(r)t.extend(r.options,e);else{var o=t.extend({},t.fn.datalist.defaults,t.fn.datalist.parseOptions(this),e);o.columns=t.extend(!0,[],o.columns),r=t.data(this,"datalist",{options:o})}if(a(this),!r.options.data){var s=t.fn.datalist.parseData(this);s.total&&t(this).datalist("loadData",s)}})},t.fn.datalist.methods={options:function(a){return t.data(a[0],"datalist").options}},t.fn.datalist.parseOptions=function(a){return t.extend({},t.fn.datagrid.parseOptions(a),t.parser.parseOptions(a,["valueField","textField","groupField",{checkbox:"boolean",lines:"boolean"}]))},t.fn.datalist.parseData=function(a){var e=t.data(a,"datalist").options,r={total:0,rows:[]};return t(a).children().each(function(){var a=t.parser.parseOptions(this,["value","group"]),o={},s=t(this).html();o[e.valueField]=void 0!=a.value?a.value:s,o[e.textField]=s,e.groupField&&(o[e.groupField]=a.group),r.total++,r.rows.push(o)}),r},t.fn.datalist.defaults=t.extend({},t.fn.datagrid.defaults,{fitColumns:!0,singleSelect:!0,showHeader:!1,checkbox:!1,lines:!1,valueField:"value",textField:"text",groupField:"",view:e,textFormatter:function(t,a){return t},groupFormatter:function(t,a){return t}})}(jQuery);