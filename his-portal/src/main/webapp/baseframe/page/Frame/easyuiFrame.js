function clickMenu(e,t,a){$("#sub_"+e).hide(),addTab(t,base_url+a)}function addTab(e,t){if($("#tabs").tabs("exists",e)){$("#tabs").tabs("select",e);var a=$("#tabs").tabs("getSelected");void 0!=t&&"Home"!=a.panel("options").title&&$("#tabs").tabs("update",{tab:a,options:{content:createFrame(t)}})}else{var n=createFrame(t);$("#tabs").tabs("add",{title:e,content:n,closable:!0})}tabClose()}function createFrame(e){var t='<iframe scrolling="auto" frameborder="0"  src="'+e+'" style="width:100%;height:100%;"></iframe>';return t}function tabClose(){$(".tabs-inner").dblclick(function(){var e=$(this).children(".tabs-closable").text();$("#tabs").tabs("close",e)}),$(".tabs-inner").bind("contextmenu",function(e){var t=$("#tabs").tabs("getSelected"),a=t.panel("options").title;"Home"==a?($("#mm-tabclose").hide(),$("#mm-tabcloseall").hide()):($("#mm-tabclose").show(),$("#mm-tabcloseall").show()),$("#mm").menu("show",{left:e.pageX,top:e.pageY});var n=$(this).children(".tabs-closable").text();return $("#mm").data("currtab",n),$("#tabs").tabs("select",n),!1})}function tabCloseEven(){$("#mm-tabupdate").click(function(){var e=$("#tabs").tabs("getSelected"),t=$(e.html()).attr("src");void 0!=t&&$("#tabs").tabs("update",{tab:e,options:{content:createFrame(t)}})}),$("#mm-tabclose").click(function(){var e=$("#mm").data("currtab");$("#tabs").tabs("close",e)}),$("#mm-tabcloseall").click(function(){$(".tabs-inner span").each(function(e,t){var a=$(t).text();"Home"!=a&&$("#tabs").tabs("close",a)})}),$("#mm-tabcloseother").click(function(){var e=$(".tabs-selected").prevAll(),t=$(".tabs-selected").nextAll();$(".tabs-selected .tabs-title").html();return e.length>0&&e.each(function(e,t){var a=$("a:eq(0) span",$(t)).text();"Home"!=a&&$("#tabs").tabs("close",a)}),t.length>0&&t.each(function(e,t){var a=$("a:eq(0) span",$(t)).text();"Home"!=a&&$("#tabs").tabs("close",a)}),!1}),$("#mm-tabcloseright").click(function(){var e=$(".tabs-selected").nextAll();return 0==e.length?(alert("后边没有啦~~"),!1):(e.each(function(e,t){var a=$("a:eq(0) span",$(t)).text();$("#tabs").tabs("close",a)}),!1)}),$("#mm-tabcloseleft").click(function(){var e=$(".tabs-selected").prevAll();return 0==e.length?(alert("到头了，前边没有啦~~"),!1):(e.each(function(e,t){var a=$("a:eq(0) span",$(t)).text();$("#tabs").tabs("close",a)}),!1)}),$("#mm-exit").click(function(){$("#mm").menu("hide")})}function accountNum(){if($("#tabs").tabs("exists","用户信息")){$("#tabs").tabs("select","用户信息");var e=$("#tabs").tabs("getSelected"),t=$(e.panel("options").content).attr("src")}else{var t=base_url+"sys/userInformation.action",a='<iframe scrolling="auto" frameborder="0"  src="'+t+'" style="width:100%;height:100%;"></iframe>';$("#tabs").tabs("add",{title:"用户信息",content:a,closable:!0})}}function zhuti(){clickMenu("zhuti","主题设置","baseframe/page/themes/themes.jsp")}function AdddilogModel(e,t,a,n,l){setTimeout(function(){$("#"+e).dialog({title:t,width:n,height:l,closed:!1,cache:!1,href:a,modal:!0})},0)}function changeRoleDept(){var e=base_url+"mainAction!roleDeptSelect";AdddilogModel("selectroledept","切换角色",e,940,610)}function restlogin(){var e=base_url+"oa/otherProjectEntries/otherProjectList.action";AdddilogModel("restlogin","其他系统登录",e,940,610)}function upDataPage(){resetPageAll($("#tabs .tabs-panels .panel-body"))}function isFullScreen(e){return e.document.body.scrollHeight>=e.window.screen.height&&e.document.body.scrollWidth>=e.window.screen.width}function requestFullScreen(e){var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen;if(t)t.call(e),upDataPage();else if("undefined"!=typeof window.ActiveXObject){var a=new ActiveXObject("WScript.Shell");null!==a&&(a.SendKeys("{F11}"),upDataPage())}}function exitFull(e){if(e.exitFullscreen)e.exitFullscreen(),upDataPage();else if(e.mozCancelFullScreen)e.mozCancelFullScreen(),upDataPage();else if(e.webkitCancelFullScreen)e.webkitCancelFullScreen(),upDataPage();else if(e.msExitFullscreen)e.msExitFullscreen(),upDataPage();else{var t=new ActiveXObject("WScript.Shell");null!==t&&(t.SendKeys("{F11}"),upDataPage())}}function upDataPage(){$("#tabs .tabs-panels .panel iframe").each(function(){this.src=this.src})}function loginout(){alert("loginout")}function loadMenu(e,t){$.ajax({url:"sys/queryMenuList.action",type:"post",success:function(a){var n=a;if(n&&n.length){e>-1&&$("#navDiv").empty(),e>0?$("#navDiv").append('<ul id="topnav"><li class="first">&nbsp;</li><li class="nav-left-arrow"><a href="javascript:loadMenu('+pageArr[t-2]+","+(t-1)+');"><<</a></li>'):$("#navDiv").append('<ul id="topnav"><li class="first">&nbsp;</li>');var l=100,s=0,i=0,r=0;e>0&&(r=e);for(var o=r;o<n.length;o++){var c=n[o],u=c.text;if(c.text.length>9&&(u=c.text.substring(0,8)+".."),"1"==c.level){i=0;var d=142*(s+1)+30,p=0,h=.8*$("body").width();p=c.last&&"1"==c.last?0:30,e>0&&(p+=30),d+=p,"0"==c.hav?(1!=l&&100!=l&&$("#li_"+s).append("</ul></div></li>"),s++,d>h?($("#topnav").append('<li class="nav-right-arrow"><a href="javascript:loadMenu('+o+","+(t+1)+');">>></a></li><ul></div></li>'),t+1>pageArr.length&&(pageArr[pageArr.length]=o),o=n.length):($("#topnav").append('<li class="nav-menu" id="li_'+s+'"><a href="javascript:void(0)">'+u+"</a></li>"),$("#li_"+s).append('<div class="sub" id="sub_'+s+'">'))):(s++,d>h?($("#topnav").append('<li class="nav-right-arrow"><a href="javascript:loadMenu('+o+","+(t+1)+');">>></a></li><ul></div></li>'),t+1>pageArr.length&&(pageArr[pageArr.length]=o),o=n.length):$("#topnav").append('<li class="nav-menu" id="li_'+s+'"><a href="javascript:clickMenu(\''+s+"','"+c.text+"','"+c.url+"')\">"+u+"</a></li>")),1!=l&&(l=1)}else"2"==c.level?(1==l?(i++,$("#sub_"+s).append('<ul id="ul_'+s+"_"+i+'">')):3==l&&(i++,$("#sub_"+s).append("</ul>"),$("#sub_"+s).append('<ul id="ul_'+s+"_"+i+'">')),"0"==c.hav?(2==l&&(i++,$("#sub_"+s).append("</ul>"),$("#sub_"+s).append('<ul id="ul_'+s+"_"+i+'">')),$("#ul_"+s+"_"+i).append('<li class="second-menu fontBg">'+c.text+"</li>")):$("#ul_"+s+"_"+i).append("<li><a href=\"javascript:clickMenu('"+s+"','"+c.text+"','"+c.url+'\')" title="'+c.text+'">'+u+"</a></li>"),2!=l&&(l=2)):"3"==c.level&&($("#ul_"+s+"_"+i).append("<li><a href=\"javascript:clickMenu('"+s+"','"+c.text+"','"+c.url+'\')" title="'+c.text+'">'+u+"</a></li>"),l<3&&(l=3))}$("#navDiv").append("</ul>"),e==-1&&$("#navDiv").show();var b={sensitivity:2,interval:100,over:megaHoverOver,timeout:100,out:megaHoverOut};$("ul#topnav li .sub").css({opacity:"0"}),$("ul#topnav li.nav-menu").hoverIntent(b)}var f=$("#p").height();$("#topnav .nav-menu .sub ul").each(function(e,t){36*$(t).children("li").length>f-30&&$(t).slimscroll({height:f-30+"px",width:"200px",wheelStep:10,size:"12px"})})}})}function megaHoverOver(){if($(this).find(".sub").stop().fadeTo("fast",1).show(),function(e){jQuery.fn.calcSubWidth=function(){rowWidth=0,e(this).find("ul").each(function(){rowWidth+=e(this).width()})}}(jQuery),$(this).find(".row").length>0){var e=0;$(this).find(".row").each(function(){$(this).calcSubWidth(),rowWidth>e&&(e=rowWidth)}),$(this).find(".sub").css({width:e}),$(this).find(".row:last").css({margin:"0"})}else{$(this).calcSubWidth(),$(this).find(".sub").css({width:rowWidth});var t=$(this).find(".sub");if(t.length>0){var a=t.attr("id").substring(4)-0,n=$("body").width(),l=152*(a-1)+60;l+rowWidth+20>n&&$(this).find(".sub").css("margin-left",n-rowWidth-l-20+"px")}}}function megaHoverOut(){$(this).find(".sub").stop().fadeTo("fast",0,function(){$(this).hide()})}var base_url=$("base").attr("href");$(function(){tabCloseEven(),history.pushState(null,null,document.URL),window.addEventListener("popstate",function(){history.pushState(null,null,document.URL)});var e=base_url+"oa/userPortal/listUserPortal.action?menuAlias=OASY";$("<iframe width='100%' height='100%' frameborder='0' id='homeIfr'></iframe>").prependTo("#homeDiv"),$("#homeIfr").attr("src",e),tabClose(),$(".cs-navi-tab").click(function(){var e=$(this),t=e.attr("src"),a=e.text();addTab(a,t)}),window.using=easyloader.load,easyloader.locale="zh_CN",easyloader.base="baseframe/easyui1.4.5/",easyloader.theme="honry",using("tabs",function(){loadMenu(-1,1)}),using("dialog");var t=!1;$("#fullscreen").on("click",function(){t?(t=!t,$(".main-top").css("height","78px"),$("#p").css("top","114px"),$(".btnBox").css("top","22px"),$(".btnBox a").css("paddingTop","7px"),exitFull(window.parent.document)):(t=!t,$(".btnBox").css("top","0"),$(".main-top").css("height","0"),$("#p").css("top","36px"),$(".btnBox a").css("paddingTop","0"),requestFullScreen(window.parent.document.documentElement))})});var pageArr=new Array;pageArr[pageArr.length]=0;