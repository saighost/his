<%@ page language="java" import="java.util.*" pageEncoding="utf-8"%>
<%@ include file="/common/taglibs.jsp"%>
<%@ include file="/common/metas.jsp"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>业务数据初始化</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <link href="${pageContext.request.contextPath}/initStyle/jquery-ui-themes.css" type="text/css" rel="stylesheet"/>
    <link href="${pageContext.request.contextPath}/initStyle/axure_rp_page.css" type="text/css" rel="stylesheet"/>
    <link href="${pageContext.request.contextPath}/initStyle/styles.css" type="text/css" rel="stylesheet"/>
    <style type="text/css">
    	body,html{
    		width: 100%;
    		height: 100%;
    		position: relative;
    	}
    	#base{
    	    width: 100%;
		    position: relative;
		    height: 100%;
		    margin-top: -195px;
	    }
    </style>

  </head>
  <body >
    <div id="base" class="">

     

      <!-- Unnamed (矩形) -->
      <div id="u3003" class="ax_default box_2">
        <div id="u3003_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3004" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3005" class="ax_default box_2">
        <div id="u3005_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3006" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (水平线) -->
      <div id="u3007" class="ax_default line">
        <img id="u3007_img" class="img " src="${pageContext.request.contextPath}/initImage/u3007.png"/>
        <!-- Unnamed () -->
        <div id="u3008" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
  <!--     <div id="u3009" class="ax_default box_2">
        <div id="u3009_div" class=""></div>
        Unnamed ()
        <div id="u3010" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div> -->

      <!-- Unnamed (矩形) -->
      <div id="u3011" class="ax_default box_2">
        <div id="u3011_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3012" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3013" class="ax_default box_2">
        <div id="u3013_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3014" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3015" class="ax_default box_2">
        <div id="u3015_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3016" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (水平线) -->
      <div id="u3017" class="ax_default line">
        <img id="u3017_img" class="img " src="${pageContext.request.contextPath}/initImage/u3017.png"/>
        <!-- Unnamed () -->
        <div id="u3018" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
     <!--  <div id="u3019" class="ax_default label">
        <div id="u3019_div" class=""></div>
        Unnamed ()
        <div id="u3020" class="text" style="visibility: visible;">
          <p><span style="color: #000">业务数据</span></p>
        </div>
      </div> -->

      <!-- Unnamed (水平线) -->
      <div id="u3021" class="ax_default line">
        <img id="u3021_img" class="img " src="${pageContext.request.contextPath}/initImage/u3017.png"/>
        <!-- Unnamed () -->
        <div id="u3022" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3023" class="ax_default label">
        <div id="u3023_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3024" class="text" style="visibility: visible;">
          <p><span style="color: #000">即时聊天账户</span></p>
        </div>
      </div>

      <!-- Unnamed (水平线) -->
      <div id="u3025" class="ax_default line">
        <img id="u3025_img" class="img " src="${pageContext.request.contextPath}/initImage/u3017.png"/>
        <!-- Unnamed () -->
        <div id="u3026" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3027" class="ax_default label">
        <div id="u3027_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3028" class="text" style="visibility: visible;">
          <p><span style="color: #000">通讯录 </span></p>
        </div>
      </div>

      <!-- Unnamed (水平线) -->
      <div id="u3029" class="ax_default line">
        <img id="u3029_img" class="img " src="${pageContext.request.contextPath}/initImage/u3017.png"/>
        <!-- Unnamed () -->
        <div id="u3030" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3031" class="ax_default label">
        <div id="u3031_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3032" class="text" style="visibility: visible;">
          <p><span style="color: #000">导入员工EXCEL</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <!-- <div id="u3033" class="ax_default box_3">
        <div id="u3033_div" class=""></div>
        Unnamed ()
        <div id="u3034" class="text" style="visibility: visible;" >
          <p style="text-align: center;" onclick="clearData()"  ><span >初始化</span></p>
        </div>
      </div>-->
 
      <!-- Unnamed (矩形) -->
      <div id="u3035" class="ax_default box_3" style="cursor: pointer;">
        <div id="u3035_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3036" class="text" style="visibility: visible;">
          <p style="text-align: center;" onclick="initialize()"><span>初始化</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3037" class="ax_default box_3" style="cursor: pointer;">
        <div id="u3037_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3038" class="text" style="visibility: visible;">
          <p style="text-align: center;" onclick="initAddress()"><span>初始化</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3039" class="ax_default box_3" style="cursor: pointer;">
        <div id="u3039_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3040" class="text" style="visibility: visible;">
          <p style="text-align: center;" onclick="empExcel()"><span>导入</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
     <%--  <div id="u3041" class="ax_default label">
        <div id="u3041_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3042" class="text" style="visibility: visible;">
          <p><span><input type="radio" value="1" name="r" id="r1" />&nbsp;日程安排</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3043" class="ax_default label">
        <div id="u3043_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3044" class="text" style="visibility: visible;">
          <p><span><input type="radio" value="2" name="r" id="r2" />&nbsp;记事本</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3045" class="ax_default label">
        <div id="u3045_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3046" class="text" style="visibility: visible;">
          <p><span><input type="radio" value="3" name="r" id="r3" />&nbsp;意见箱</span></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3047" class="ax_default label">
        <div id="u3047_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3048" class="text" style="visibility: visible;">
          <p><span><input type="radio" value="4" name="r" id="r4" />&nbsp;待办已办</span></p>
        </div>
      </div>--%>

      <!-- Unnamed (图片) -->
      <div id="u3049" class="ax_default _图片">
        <img id="u3049_img" class="img " src="${pageContext.request.contextPath}/initImage/u3049.png"/>
        <!-- Unnamed () -->
        <div id="u3050" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div> 

      <!-- Unnamed (图片) -->
      <div id="u3051" class="ax_default _图片">
        <img id="u3051_img" class="img " src="${pageContext.request.contextPath}/initImage/u3051.png"/>
        <!-- Unnamed () -->
        <div id="u3052" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (图片) -->
      <div id="u3053" class="ax_default _图片">
        <img id="u3053_img" class="img " src="${pageContext.request.contextPath}/initImage/u3053.png"/>
        <!-- Unnamed () -->
        <div id="u3054" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (动态面板) -->
      <div id="u3055" class="ax_default ax_default_hidden" style="display: none; visibility: hidden">
        <div id="u3055_state0" class="panel_state" data-label="State1">
          <div id="u3055_state0_content" class="panel_state_content">

            <!-- Unnamed (矩形) -->
            <div id="u3056" class="ax_default box_1">
              <img id="u3056_img" class="img " src="${pageContext.request.contextPath}/initImage/u3056.png"/>
              <!-- Unnamed () -->
              <div id="u3057" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>

            <!-- Unnamed (图片) -->
            <div id="u3058" class="ax_default _图片">
              <img id="u3058_img" class="img " src="${pageContext.request.contextPath}/initImage/u3058.png"/>
              <!-- Unnamed () -->
              <div id="u3059" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>
          </div>
        </div>
        <div id="u3055_state1" class="panel_state" data-label="State2" style="display: none; visibility: hidden;">
          <div id="u3055_state1_content" class="panel_state_content">

            <!-- Unnamed (矩形) -->
            <div id="u3060" class="ax_default box_1">
              <img id="u3060_img" class="img " src="${pageContext.request.contextPath}/initImage/u3056.png"/>
              <!-- Unnamed () -->
              <div id="u3061" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>

            <!-- Unnamed (图片) -->
            <div id="u3062" class="ax_default _图片">
              <img id="u3062_img" class="img " src="${pageContext.request.contextPath}/initImage/u3062.png"/>
              <!-- Unnamed () -->
              <div id="u3063" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>
          </div>
        </div>
        <div id="u3055_state2" class="panel_state" data-label="State3" style="display: none; visibility: hidden;">
          <div id="u3055_state2_content" class="panel_state_content">

            <!-- Unnamed (矩形) -->
            <div id="u3064" class="ax_default box_1">
              <img id="u3064_img" class="img " src="${pageContext.request.contextPath}/initImage/u3056.png"/>
              <!-- Unnamed () -->
              <div id="u3065" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>

            <!-- Unnamed (图片) -->
            <div id="u3066" class="ax_default _图片">
              <img id="u3066_img" class="img " src="${pageContext.request.contextPath}/initImage/u3066.png"/>
              <!-- Unnamed () -->
              <div id="u3067" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>
          </div>
        </div>
        <div id="u3055_state3" class="panel_state" data-label="State4" style="display: none; visibility: hidden;">
          <div id="u3055_state3_content" class="panel_state_content">

            <!-- Unnamed (矩形) -->
            <div id="u3068" class="ax_default box_1">
              <img id="u3068_img" class="img " src="${pageContext.request.contextPath}/initImage/u3056.png"/>
              <!-- Unnamed () -->
              <div id="u3069" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>

            <!-- Unnamed (图片) -->
            <div id="u3070" class="ax_default _图片">
              <img id="u3070_img" class="img " src="${pageContext.request.contextPath}/initImage/u3070.png"/>
              <!-- Unnamed () -->
              <div id="u3071" class="text" style="display: none; visibility: hidden">
                <p><span></span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Unnamed (椭圆形) -->
      <div id="u3072" class="ax_default ellipse">
        <!-- Unnamed () -->
        <div id="u3073" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (椭圆形) -->
      <div id="u3074" class="ax_default ellipse">
        <!-- Unnamed () -->
        <div id="u3075" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (椭圆形) -->
      <div id="u3076" class="ax_default ellipse">
        <!-- Unnamed () -->
        <div id="u3077" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (椭圆形) -->
      <div id="u3078" class="ax_default ellipse">
        <!-- Unnamed () -->
        <div id="u3079" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (椭圆形) -->
      <div id="u3080" class="ax_default ellipse">
        <!-- Unnamed () -->
        <div id="u3081" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div>

      <!-- Unnamed (图片) -->
  <%--     <div id="u3082" class="ax_default _图片">
        <img id="u3082_img" class="img " src="${pageContext.request.contextPath}/initImage/u3082.png"/>
        <!-- Unnamed () -->
        <div id="u3083" class="text" style="display: none; visibility: hidden">
          <p><span></span></p>
        </div>
      </div> --%>

      <!-- Unnamed (矩形) -->
      <div id="u3084" class="ax_default box_1">
        <!-- Unnamed () -->
        <div id="u3085" class="text" style="visibility: visible;">
          <p>
	          <span>
		        	<form id="empForm" enctype="multipart/form-data" method="post">
		                <input type="file" id="empFile" name="empFile" style="clear:both;margin-top:10px;"> 
	              	</form>
	              	
	           </span>
	     </p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3086" class="ax_default label">
        <div id="u3086_div" class=""></div>
        <!-- Unnamed () -->
        <div id="u3087" class="text" style="visibility: visible;">
          <p>
	          <span>
	          	 <a href="javascript:void(0)" id="ts" onclick="sendMes()" class="easyui-linkbutton" >推送通知</a>
	          </span>
          </p>
        </div>
      </div>
    </div>
    <script type="text/javascript">
	function clearData(){
		var val =$('input:radio:checked').val();
		var msg=""
		if(val==1){
			msg="初始化会清空日程安排相关数据，确定要初始化吗？";
		}else if(val==2){
			msg="初始化会清空记事本数据，确定要初始化吗？";
		}else if(val==3){
			msg="初始化会清空意见箱相关数据，确定要初始化吗？";
		}else if(val==4){
			msg="初始化会清空待办已办相关数据，确定要初始化吗？";
		}else{
			$.messager.alert('提示信息','请选择初始化项目！！');
			return;
		}
		$.messager.confirm('确认', msg, function(res){//提示是否删除
			if(res){
			 $.messager.confirm('确认', "请再次确认！", function(r){//提示是否删除
				    if(r){
				    	$.messager.progress({
				    		title:"提示",
				    		msg:"数据初始化中，请稍候...",
				    	}); 
				    	$.ajax({
				    		url: "<%=basePath%>mosys/clearData/clear.action?flag="+val, 
							type:'post',
							success: function(data) {
								if(data=="success"){
									$.messager.alert('提示信息','数据初始化成功！');
									$.messager.progress('close');
								}else{
									$.messager.alert('提示信息','数据初始化失败！');
									$.messager.progress('close');
								}
							}
					});
				  }
		         });
			}
     });
	}
	
	function sendMes(){
		$.messager.confirm('确认', "确认要推送通知吗？？", function(res){//提示是否删除
			if(res){
			 $.messager.confirm('确认', "请再次确认！", function(r){//提示是否删除
				    if(r){
				    	$.messager.progress({
				    		title:"提示",
				    		msg:"推送中，请稍候...",
				    	}); 
				    	$.ajax({
				    		url: "<%=basePath%>mosys/clearData/sendMes.action", 
							type:'post',
							success: function(data) {
								if(data=="success"){
									$.messager.alert('提示信息','推送通知成功！');
									$.messager.progress('close');
								}else{
									$.messager.alert('提示信息','推送通知失败！');
									$.messager.progress('close');
								}
							}
					});
				  }
		         });
			}
     });
	}
	function initialize(){
		$.messager.confirm('确认',"确认要进行即时聊天账户初始化吗？？", function(res){//提示是否删除
			if(res){
			 $.messager.confirm('确认', "请再次确认！", function(r){//提示是否删除
				    if(r){
				    	$.messager.progress({
				    		title:"提示",
				    		msg:"数据初始化中，请稍候...",
				    	}); 
				    	$.ajax({
				    		url: "<%=basePath%>mosys/openFireInitAction/openFireInit.action", 
							type:'post',
							success: function(data) {
								if(data=="success"){
							    	$.messager.alert('提示信息','数据初始化成功！');
								    $.messager.progress('close');
								}else{
									$.messager.alert('提示信息','数据初始化失败！');
								    $.messager.progress('close');
								}
							}
					});
				  }
		         });
			}
     });
	}
	function initAddress(){
		$.messager.confirm('确认',"确认要进行通讯录初始化吗？？", function(res){//提示是否删除
			if(res){
			 $.messager.confirm('确认', "请再次确认！", function(r){//提示是否删除
				    if(r){
				    	$.messager.progress({text:'初始化中，请稍后...',modal:true});
				    	$.ajax({
				    		url: "<%=basePath%>mosys/quartzToDBFile/quartzToDBFile.action", 
							type:'post',
							success: function(data) {
								$.messager.progress('close');
								$.messager.alert('提示信息',data.resMsg);
							}
					});
				  }
		         });
			}
     });
	}
	
	
	//员工Excel导入
	function empExcel(){
		var file = $('#empFile').val();
		if(file==null||file==""){
			$.messager.alert('提示信息',"请选择导入文件");
    		return false;
		}
		var index = file.lastIndexOf(".");
		if(index < 0){
			$.messager.alert('提示信息',"文件格式不正确!");
			return false;
		}else{
			var ext = file.substring(index + 1, file.length);
			if(ext == "xls"||ext == "xlsx") {
				$('#empForm').form('submit', {
					url : "<%=basePath%>mosys/importExcel/uploadeExcel.action",
					onSubmit : function() {
						if(!$('#empForm').form('validate')){
							$.messager.alert('提示信息','验证没有通过,不能提交表单!');
							close_alert();
							return false ;
						}
						$.messager.progress({text:'保存中，请稍后...',modal:true});
					},
					success:function(data){ 
						var res = eval("(" + data + ")");
						$.messager.progress('close');
						$.messager.alert('提示',res.resMsg);
						close_alert();
					}
				});
			}else{
				$.messager.alert('提示信息',"文件格式不正确!");
	    		return false;
			}
		}
    	
	}
	
	//公共编码初始化
	function initBusinessDictionary(){
		$.messager.confirm('确认',"确认要进行公共编码初始化吗？", function(res){//提示是否删除
			if(res){
			 $.messager.confirm('确认', "请再次确认！", function(r){//提示是否删除
				    if(r){
				    	$.messager.progress({
				    		title:"提示",
				    		msg:"数据初始化中，请稍候...",
				    	}); 
				    	$.ajax({
				    		url: "<%=basePath%>mosys/initData/initBusinessDictionaryData.action", 
							type:'post',
							success: function() {
								$.messager.alert('提示信息','数据初始化成功！');
								$.messager.progress('close');
							}
					});
				  }
		         });
			}
     });
	}
	</script>
    
  </body>
</html>
