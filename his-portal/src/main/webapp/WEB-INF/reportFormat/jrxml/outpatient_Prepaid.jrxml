<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
		 name="outpatient_Prepaid"
		 columnCount="1"
		 printOrder="Vertical"
		 orientation="Portrait"
		 pageWidth="595"
		 pageHeight="842"
		 columnWidth="535"
		 columnSpacing="0"
		 leftMargin="30"
		 rightMargin="30"
		 topMargin="20"
		 bottomMargin="20"
		 whenNoDataType="NoPages"
		 isTitleNewPage="false"
		 isSummaryNewPage="false">
	<property name="ireport.scriptlethandling" value="0" />
	<property name="ireport.encoding" value="UTF-8" />
	<import value="java.util.*" />
	<import value="net.sf.jasperreports.engine.*" />
	<import value="net.sf.jasperreports.engine.data.*" />

	<parameter name="tid" isForPrompting="false" class="java.lang.String"/>
	<parameter name="hospital" isForPrompting="false" class="java.lang.String"/>
	<queryString><![CDATA[select c.detail_debitamount as debitamount,
      MONEY2CHINESE(c.detail_debitamount) as debitamount_da,
       NVL2(c.createuser,
            (select e.employee_name
               from t_employee e
              where user_id = c.createuser),
            null) as createuser,
	to_char(c.createtime, 'yyyy-mm-dd hh24: mi: ss')as createtime,
       c.detail_id as invoiceno,
       to_char(sysdate, 'yyyy-mm-dd hh24: mi: ss') as s_date,
       NVL2(sysdate,
            (select t.patient_name
               from t_patient t
              where patinent_id = (select d.patinent_id
                                     from t_patient_idcard d
                                    where idcard_no = $P{tid})),
            null) as name --收费金额，收费人，收费时间，打印时间,患者姓名（渲染）,
  from (select b.detail_debitamount,
               b.createuser,
               b.createtime,
               b.detail_id
          from t_patient_accountrepaydetail b
         where b.account_id = --通过账户编号，得收款金额
               (select a.account_id --通过就诊卡编号，得患者账户编号
                  from t_patient_account a
                 where a.del_flg = 0 --未删除状态
                   and a.idcard_id = --通过就诊卡号，得就诊卡编号
                       (select t.idcard_id
                          from t_patient_idcard t
                         where idcard_no = $P{tid}))
           and b.detail_accounttype = 1 --账户分类 门诊
           and b.detail_optype = 1 --类型  收款
         order by b.createtime desc) c --时间排序
 where rownum = 1 --第一条]]></queryString>

	<field name="DEBITAMOUNT" class="java.lang.Double"/>
	<field name="DEBITAMOUNT_DA" class="java.lang.String"/>
	<field name="CREATEUSER" class="java.lang.String"/>
	<field name="CREATETIME" class="java.lang.String"/>
	<field name="INVOICENO" class="java.lang.String"/>
	<field name="S_DATE" class="java.lang.String"/>
	<field name="NAME" class="java.lang.String"/>

		<background>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</background>
		<title>
			<band height="34"  isSplitAllowed="true" >
				<staticText>
					<reportElement
						x="110"
						y="0"
						width="108"
						height="34"
						key="staticText-1"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font pdfFontName="STSong-Light" isBold="true" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[门诊预交金收条]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="0"
						y="0"
						width="110"
						height="34"
						key="textField-9"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement textAlignment="Left" verticalAlignment="Middle">
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$P{hospital}]]></textFieldExpression>
				</textField>
			</band>
		</title>
		<pageHeader>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageHeader>
		<columnHeader>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnHeader>
		<detail>
			<band height="300"  isSplitAllowed="true" >
				<staticText>
					<reportElement
						x="0"
						y="0"
						width="34"
						height="16"
						key="staticText-2"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[卡号：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="16"
						width="34"
						height="16"
						key="staticText-3"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[姓名：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="32"
						width="74"
						height="16"
						key="staticText-4"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[金额（小写）：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="48"
						width="74"
						height="16"
						key="staticText-5"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[金额（大写）：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="64"
						width="51"
						height="16"
						key="staticText-6"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[收款时间：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="80"
						width="51"
						height="16"
						key="staticText-7"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[打印时间：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="96"
						width="40"
						height="16"
						key="staticText-8"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[收款人：]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="112"
						width="134"
						height="29"
						key="staticText-9"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[交费后，押金条请您妥善保管
正式结算后此押金条作废]]></text>
				</staticText>
				<staticText>
					<reportElement
						x="0"
						y="141"
						width="61"
						height="16"
						key="staticText-10"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<text><![CDATA[预交金编号：]]></text>
				</staticText>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="34"
						y="0"
						width="171"
						height="16"
						key="textField-1"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$P{tid}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="34"
						y="16"
						width="171"
						height="16"
						key="textField-2"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{NAME}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="74"
						y="32"
						width="131"
						height="16"
						key="textField-3"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.Double"><![CDATA[$F{DEBITAMOUNT}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="74"
						y="48"
						width="131"
						height="16"
						key="textField-4"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{DEBITAMOUNT_DA}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="51"
						y="64"
						width="154"
						height="16"
						key="textField-5"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{CREATETIME}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="51"
						y="80"
						width="167"
						height="16"
						key="textField-6"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{S_DATE}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="40"
						y="96"
						width="178"
						height="16"
						key="textField-7"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{CREATEUSER}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="false" isBlankWhenNull="true" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
					<reportElement
						x="61"
						y="141"
						width="208"
						height="16"
						key="textField-8"/>
					<box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#000000" bottomBorder="None" bottomBorderColor="#000000"/>
					<textElement>
						<font pdfFontName="STSong-Light" pdfEncoding ="UniGB-UCS2-H"/>
					</textElement>
				<textFieldExpression   class="java.lang.String"><![CDATA[$F{INVOICENO}]]></textFieldExpression>
				</textField>
			</band>
		</detail>
		<columnFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</columnFooter>
		<pageFooter>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</pageFooter>
		<summary>
			<band height="0"  isSplitAllowed="true" >
			</band>
		</summary>
</jasperReport>
